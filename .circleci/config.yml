# PHP CircleCI 2.0 configuration file
#
# Check https://circleci.com/docs/2.0/language-php/ for more details
#
version: 2
jobs:
  build:
    docker:
      # Specify the version you desire here
      - image: circleci/php:7.1.8-browsers

    steps:
      - checkout

      - run:
          name: Display PHP version
          command: php -v

      # Run tests
      ### Generate
      - php generate -debug < tests/generate_simple.txt
      - "[ -e test.dat ] && echo 'File test.dat exists' || (echo 'File test.dat not exists!!' && fake_command_to_stop_build)"
      - php generate -debug < tests/generate_directory.txt
      - "[ -e test/test.dat ] && echo 'File test/test.dat exists' || (echo 'File test/test.dat not exists!!' && fake_command_to_stop_build)"
      - php generate -debug < tests/generate_default_numbers.txt
      - "[ -e default_numbers.dat ] && echo 'File default_numbers.dat exists' || (echo 'File default_numbers.dat not exists!!' && fake_command_to_stop_build)"
      # Test for positive confirmation
      - php generate -debug < tests/generate_simple.txt
      - php generate -debug < tests/generate_negative_confirmation.txt
      # Generating large files
      - php generate -debug < tests/generate_10MB_file.txt
      - "[ -e 10MB.dat ] && echo 'File 10MB.dat exists' || (echo 'File 10MB.dat not exists!!' && fake_command_to_stop_build)"
      - php generate -debug < tests/generate_1GB_file.txt
      - "[ -e 1GB.dat ] && echo 'File 1GB.dat exists' || (echo 'File 1GB.dat not exists!!' && fake_command_to_stop_build)"
